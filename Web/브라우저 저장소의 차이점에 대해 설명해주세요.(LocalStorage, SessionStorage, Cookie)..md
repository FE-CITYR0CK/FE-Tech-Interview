# 브라우저 저장소의 차이점에 대해 설명해 주세요.(LocalStorage, SessionStorage, Cookie)

<br/>

## 면접용

브라우저 저장소인 LocalStorage, SessionStorage, Cookie는 각각 데이터를 저장하는 방식과 특성에서 차이가 있습니다. HTML5부터는 쿠키의 단점을 보완해 등장한 웹스토리지를 주로 사용합니다.

먼저 웹스토리지는 지속성에 따라 로컬 스토리지와 세션 스토리지로 구분할 수 있습니다. 

 **LocalStorage**는 영구적인 데이터 저장소로, 브라우저를 종료해도 데이터가 유지됩니다. 용량은 일반적으로 5MB 정도이며, 도메인별로 독립적인 저장소를 가집니다. JavaScript를 통해 쉽게 접근이 가능하고, 서버로 자동 전송되지 않기 때문에 네트워크 부하가 없습니다.

**SessionStorage**는 LocalStorage와 유사하지만, 브라우저 세션이 유지되는 동안만 데이터가 저장됩니다. 사용자가 특정 탭이나 창을 닫으면 해당 세션의 데이터는 삭제됩니다. 이는 임시 정보나 단일 세션 내에서만 필요한 데이터를 저장하는 데 적합합니다. 

**Cookie**는 서버와 클라이언트 간의 상태 정보를 유지하는 데 사용됩니다. 주요 특징은 HTTP 요청 시 자동으로 서버에 전송된다는 점입니다. 용량이 약 4KB로 제한적이며, 만료일을 설정할 수 있어 특정 기간 동안만 데이터를 유지할 수 있습니다. 또한 secure, httpOnly와 같은 보안 옵션을 설정할 수 있어 보안이 중요한 인증 정보에 적합합니다.

브라우저 저장소는 프로젝트에서는 목적에 맞게 적절한 저장소를 선택하는 것이 중요합니다. 예를 들어, 민감한 정보는 httpOnly 쿠키에, 사용자 기본 설정은LocalStorage에, 임시 상태는 SessionStorage에 저장하는 식으로 활용할 수 있습니다.

[꼬리질문]

### **1.LocalStorage에 JWT 토큰을 저장해도 될까요?**

LocalStorage는 JavaScript에서 쉽게 접근할 수 있어 **XSS 공격에 취약**합니다.

따라서, 로그인 토큰은 LocalStorage가 아니라 **httpOnly 쿠키**에 저장하는 것이 보안상 안전합니다.

그러나, 일부 SPA에서는 LocalStorage에 저장하고 CSRF 방어를 위해 CSRF 토큰을 따로 관리하기도 합니다.

### **2.쿠키의 보안 옵션에 대해 설명해 주세요.**

`Secure` : HTTPS에서만 쿠키를 전송할 수 있도록 설정합니다.

`HttpOnly` : JavaScript에서 접근할 수 없도록 설정하여 XSS 공격을 방지합니다.

`SameSite` : CSRF 공격을 방지하기 위해 쿠키의 전송 범위를 제한합니다. 

<br/>
<hr/>
<br/>

## 개념 설명
![Image](https://github.com/user-attachments/assets/7a9e7838-405a-4310-a016-49dcb37b949b)
### 브라우저 저장소란?
브라우저 저장소는 쿠키(Cookie) 및 HTML5부터 제공된 웹스토리지(Web Storage)를 의미합니다. 이러한 저장소는 특정 도메인에 대한 데이터를 브라우저에 저장하고, 서버와 클라이언트 간의 데이터 유지 및 전송을 위한 역할을 수행합니다.

### 쿠키(Cookies)
쿠키는 서버가 클라이언트에게 전송하는 작은 데이터 파일로, 이름,값, 도메인, 만료일자와 같은 정보를 포함할 수 있습니다. 또한 계속해서 특정 정보를  주고 받아야하는 경우라면 자동으로 모든 요청에 포함되는 쿠키가 유용합니다. 

### 동작 방식

- 클라이언트가 요청을 보낼 때, 저장된 쿠키가 해당 도메인과 함께 서버로 전송됩니다.
- 서버는 응답 시 `Set-Cookie` 헤더를 사용하여 새로운 쿠키를 설정할 수 있습니다.
- 브라우저는 js를 통해 쿠키를 만들 수 있고 서버는 응답시 쿠키를 클라이언트에게 건네 줄 수 있습니다.
- 쿠키는 사용자의 기기에 도메인별로 분리되어 저장됩니다.
- 사용자가 요청을 보낼 시 서버의 도메인에 따라서 저장된 쿠키와 함께 발신됩니다.

### 쿠키를 사용하는 목적

쿠키의 주요 사용 목적은 유저 추척, 로그인 세션 유지, 유저 설정 관리입니다.

storage가 등장하기 전에는 클라이언트 저장소로 사용되었습니다.

- 세션 관리(Sesson management)

서버에 저장해야 할 로그인, 장바구니, 게임 스코어 등의 정보 관리

- 개인화(Personalizaton)

사용자 선호, 테마 등의 세팅

- 트래킹(Tracking)

사용자 행동을 기록하고 분석하는 용도

### 쿠키 속성
- Domain: 어떤 도메인에서 쿠키를 받을 수 있을지 정의
- Secure: HTTPS에서만 사용
- HttpOnly: JS를 통한 변경 금지
- Expire: 쿠키 만료 시간
쿠키의 다양한 속성들을 쿠키가 어디로 갈지 , 어떻게 제한 될지 정의합니다.

속성들을 올바르게 조합하지 않으면, 쿠키가 작동하지 않을 수 있습니다.

Requset의 cookie 헤더에 브라우저가 보내는 쿠키가 적혀있습니다.

[ HTTP 요청 ]

```jsx
GET /sample_page.html HTTP/2.0
Host: www.test.com
Cookie: yummy_cookie=choco; tasty_cookies=strawberry
```

Response의 set-cookie 헤더에 서버가 보내는 쿠키가 적혀있습니다.

[ HTTP 응답 ]

```jsx
HTTP/1.0 200 OK
Content-type: text/html
Set-Cookie: yummy_cookie=choco
Set-Cookie: tasty_cookie=strawberry
```

### 쿠키의 한계

모든 브라우저에서 지원을 하지만 매번 서버에 전송이 되고  저장 용량이 작고 보안에 취약하다는 단점이 있습니다.

- 데이터가 유실되기 쉬움
- 보안상의 문제
    
    사용자의 정보를 추적, 저장할 수 있기 때문에 개인정보 노출에 관련된 문제가 발생할 수 있음
    
- 네트워크 트래픽
    
    모든 요청마다 쿠키가 함께 전송되기 때문에, 성능이 떨어지는 원인이 될 수 있음
    
- 부족한 저장용량(4KB)

이러한 쿠키의 문제점을 해결하기 위해 HTML5에서 Web Storage 등장하였습니다.

### Web Storage (웹 스토리지)

**Storage란?**  말 그대로 저장소를 의미하며, 브라우저의 저장 공간을 뜻합니다.

**Web Storage**는 쿠키의 단점을 보완하기 위해 HTML5부터 제공된 브라우저 저장소입니다. 클라이언트에만 데이터를 저장하고 서버로 전송되지 않으며, 키-값(Key-Value) 형태로 데이터를 저장합니다.

LocalStorage**와** SessionStorage는 같은 인터페이스를 공유합니다.

인터페이스는 storage라고 불리며, 두 스토리지는 동일한 메서드와 프로퍼티가 내장되어있습니다.

```jsx
localStorage.setItem("채널", "마이");
SessionStorage.setItem("채널", "마이");//저장하기

localStorage.getItem("채널");//가져오기

localStorage.removeItem("채널");//제거하기
```

해당 저장소들은 Origin(도메인/포트/프로토콜)에 따라서 구분됩니다.

서로 다른 사이트에서는 완전히 다른 저장소로 구분됩니다.

### localStorage란?

- 브라우저를 종료해도 데이터가 유지되는 **영구 저장소**입니다.
- 용량 제한 : **약 5MB**
- 도메인별로 독립적인 저장 공간 제공합니다.

### sessionStorage란?

`sessionStorage` 객체는 `localStorage`에 비해 자주 사용되진 않습니다.

제공하는 프로퍼티와 메서드는 같지만, 훨씬 제한적이기 때문입니다.

- `sessionStorage`는 현재 떠 있는 탭 내에서만 유지됩니다.
    - 같은 페이지라도 다른 탭에 있으면 다른 곳에 저장되기 때문입니다.
    - 그런데 하나의 탭에 여러 개의 iframe이 있는 경우엔 동일한 오리진에서 왔다고 취급되기 때문에 `sessionStorage`가 공유됩니다.
    
- 페이지를 새로 고침할 때 `sessionStorage`에 저장된 데이터는 사라지지 않습니다. 하지만 탭을 닫고 새로 열 때는 사라집니다.

### localStorage 와 sessionStorage 차이점

웹스토리지는 지속성에 따라 로컬 스토리지와 세션 스토리지로 구분할 수 있습니다.

로컬 스토리지는 브라우저 자체에 반영구적으로 데이터를 저장하고 브라우저를 종료해도 데이터가 유지 됩니다. 즉 **브라우저를 닫아도 계속해서 유지되는 정보입니다.**

세션 스토리지는 탭 윈도우 단위로 생성되고 탭 윈도우를 닫을 때 데이터가 삭제된다는 특징이 있습니다.창이 꺼지면, 사라지는 휘발성 데이터입니다.

### 저장소 활용 예시

| 저장소 | 활용 예시 |
| --- | --- |
| **Cookie** | 로그인 유지, 팝업 '다시 보지 않기' 설정 |
| **LocalStorage** | 자동 로그인, 사용자 기본 설정 저장 |
| **SessionStorage** | 입력 폼 데이터 저장, 비로그인 상태 장바구니 |

브라우저 저장소는 목적과 특성에 따라 적절히 활용하는 것이 중요합니다. 보안이 필요한 경우 `HttpOnly` 쿠키를, 영구적인 사용자 설정 저장은 `LocalStorage`를, 일시적인 데이터 유지에는 `SessionStorage`를 선택하는 것이 좋습니다.